<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <title>Welcome to Firebase Hosting</title>
    <script src="https://www.gstatic.com/firebasejs/3.6.2/firebase.js"></script>

    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyCKeQtsr3piRY1a2Z_SRnC9Mugoh13X7mc",
        authDomain: "quiz-application-76fd2.firebaseapp.com",
        databaseURL: "https://quiz-application-76fd2.firebaseio.com",
        storageBucket: "quiz-application-76fd2.appspot.com",
        messagingSenderId: "626545819362"
      }
      firebase.initializeApp(config);

     var ref = firebase.database().ref("scores");
      ref.once("value")
      .then(function(snapshot) {
        var snap = snapshot.val();
        var table = document.createElement('table')
        table.setAttribute('class', "table");
        var header = table.createTHead();
        var tbody = document.createElement('tbody');
        table.appendChild(tbody);
        var row = header.insertRow(0);
        var cell = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        cell.innerHTML = "user";
        cell2.innerHTML = "score";
        cell3.innerHTML = "Subject"
         document.getElementById("display").appendChild(table);
         var count = 0;
         console.log(snap);
         var obj = Object.values(snap);
       //  var sorted = _.sortBy(snap, "score");

        var sorted = obj.sort(function (a, b ) {
            return b.score - a.score ;
          });
         console.log(sorted);

        for(v in sorted){
          var v1 = sorted[v];
            var row = tbody.insertRow(count);
            var cell = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            cell.innerHTML = v1["user"];
            cell2.innerHTML = v1["score"];
            cell3.innerHTML = v1["Subject"];
            count++;
       }


      });
    
    </script>
  </head>
  <body>

    <nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <a class="navbar-brand" href="#">Quiz Application</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-center" >
      <label class="navbar-brand " id = "display2"> 
      </label>
    </ul>

      <ul class="nav navbar-nav navbar-right">
        <li><a href="index.html">LogOut</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
     
      <label> Leaderboard </label><br>
      <div id = "display"> </div>
      <script type="text/javascript" src="javascripts/main.js"></script>
    
      <script type="text/javascript">
      var user = window.sessionStorage.getItem("user");
      document.getElementById("display2").innerHTML = " Welcome " + user;
    </script>


    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/js/bootstrap.min.js" integrity="sha384-BLiI7JTZm+JWlgKa0M0kGRpJbF2J8q+qreVrKBC47e3K6BW78kGLrCkeRX6I9RoK" crossorigin="anonymous"></script> 
  </body>
</html>
